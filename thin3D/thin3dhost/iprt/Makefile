# Copyright (c) 2001, Stanford University
# All rights reserved.
#
# See the file LICENSE.txt for information on redistributing this software.

TOP = ..

include ${TOP}/arch.mk

#SHARED = 1
LIBRARY = iprt
LIBRARIES = ssl xml2 lzf crypt rt

FILES += \
	common/time/timesupref \
	common/math/bignum-amd64-x86 \
	common/misc/zero \
	common/err/errmsgxpcom \
	generic/RTLogDefaultInit-generic \
	generic/RTAssertShouldPanic-generic

FILES += \
	common/alloc/alloc \
	common/alloc/heapsimple \
	common/alloc/heapoffset \
	common/alloc/memcache \
	common/alloc/memtracker \
	common/asn1/asn1-basics \
	common/asn1/asn1-cursor \
	common/asn1/asn1-default-allocator \
	common/asn1/asn1-efence-allocator \
	common/asn1/asn1-dump \
	common/asn1/asn1-encode \
	common/asn1/asn1-ut-bitstring \
	common/asn1/asn1-ut-bitstring-decode \
	common/asn1/asn1-ut-boolean \
	common/asn1/asn1-ut-boolean-decode \
	common/asn1/asn1-ut-core \
	common/asn1/asn1-ut-core-decode \
	common/asn1/asn1-ut-dyntype \
	common/asn1/asn1-ut-dyntype-decode \
	common/asn1/asn1-ut-integer \
	common/asn1/asn1-ut-integer-decode \
	common/asn1/asn1-ut-null \
	common/asn1/asn1-ut-null-decode \
	common/asn1/asn1-ut-objid \
	common/asn1/asn1-ut-objid-decode \
	common/asn1/asn1-ut-octetstring \
	common/asn1/asn1-ut-octetstring-decode \
	common/asn1/asn1-ut-string \
	common/asn1/asn1-ut-string-decode \
	common/asn1/asn1-ut-time \
	common/asn1/asn1-ut-time-decode \
	common/checksum/adler32 \
	common/checksum/crc32 \
	common/checksum/crc32c \
	common/checksum/crc64 \
	common/checksum/alt-md2 \
	common/checksum/alt-md5 \
	common/checksum/alt-sha1 \
	common/checksum/alt-sha256 \
	common/checksum/alt-sha512 \
	common/checksum/md2str \
	common/checksum/md5str \
	common/checksum/ipv4 \
	common/checksum/ipv6 \
	common/checksum/manifest \
	common/checksum/manifest2 \
	common/checksum/manifest3 \
	common/checksum/manifest-file \
	common/checksum/RTSha1Digest \
	common/checksum/RTSha256Digest \
	common/checksum/sha1str \
	common/checksum/sha224str \
	common/checksum/sha256str \
	common/checksum/sha384str \
	common/checksum/sha512str \
	common/checksum/sha512t224str \
	common/checksum/sha512t256str \
	common/checksum/x509 \
	common/crypto/digest-core \
	common/crypto/digest-builtin \
	common/crypto/iprt-openssl \
	common/crypto/rsa-asn1-decoder \
	common/crypto/rsa-core \
	common/crypto/rsa-init \
	common/crypto/rsa-sanity \
	common/crypto/pemfile \
	common/crypto/pkcs7-asn1-decoder \
	common/crypto/pkcs7-core \
	common/crypto/pkcs7-init \
	common/crypto/pkcs7-sanity \
	common/crypto/pkcs7-verify \
	common/crypto/pkix-signature-builtin \
	common/crypto/pkix-signature-core \
	common/crypto/pkix-signature-rsa \
	common/crypto/pkix-util \
	common/crypto/pkix-verify \
	common/crypto/spc-asn1-decoder \
	common/crypto/spc-core \
	common/crypto/spc-init \
	common/crypto/spc-sanity \
	common/crypto/x509-asn1-decoder \
	common/crypto/x509-certpaths \
	common/crypto/x509-core \
	common/crypto/x509-file \
	common/crypto/x509-init \
	common/crypto/x509-sanity \
	common/crypto/x509-verify \
	common/crypto/taf-asn1-decoder \
	common/crypto/taf-core \
	common/crypto/taf-init \
	common/crypto/taf-sanity \
	common/crypto/tsp-asn1-decoder \
	common/crypto/tsp-core \
	common/crypto/tsp-init \
	common/crypto/tsp-sanity \
	common/crypto/store \
	common/crypto/store-inmem \
	common/crypto/RTCrStoreCertAddFromFile \
	common/dbg/dbg \
	common/dbg/dbgas \
	common/dbg/dbgcfg \
	common/dbg/dbgmod \
	common/dbg/dbgmodldr \
	common/dbg/dbgmodcontainer \
	common/dbg/dbgmoddeferred \
	common/dbg/dbgmodexports \
	common/dbg/dbgmodcodeview \
	common/dbg/dbgmoddwarf \
	common/dbg/dbgmodnm \
	common/dvm/dvm \
	common/dvm/dvmbsdlabel \
	common/dvm/dvmgpt \
	common/dvm/dvmmbr \
	common/dvm/dvmvfs \
	common/err/errinfo \
	common/err/errinfo-alloc \
	common/err/errmsg \
	common/err/RTErrConvertFromErrno \
	common/err/RTErrConvertToErrno \
	common/filesystem/filesystem \
	common/filesystem/filesystemext \
	common/ldr/ldr \
	common/ldr/ldrELF \
	common/ldr/ldrEx \
	common/ldr/ldrFile \
	common/ldr/ldrMemory \
	common/ldr/ldrNative \
	common/ldr/ldrPE \
	common/log/log \
	common/log/logellipsis \
	common/log/logrel \
	common/log/logrelellipsis \
	common/log/logcom \
	common/log/logformat \
	common/log/tracebuf \
	common/log/tracedefault \
	common/math/bignum \
	common/misc/RTAssertMsg1Weak \
	common/misc/RTAssertMsg2 \
	common/misc/RTAssertMsg2Add \
	common/misc/RTAssertMsg2AddWeak \
	common/misc/RTAssertMsg2AddWeakV \
	common/misc/RTAssertMsg2Weak \
	common/misc/RTAssertMsg2WeakV \
	common/misc/RTFileModeToFlags \
	common/misc/RTFileOpenF \
	common/misc/RTFileOpenV \
	common/misc/RTMemWipeThoroughly \
	common/misc/assert \
	common/misc/buildconfig \
	common/misc/cidr \
	common/misc/getopt \
	common/misc/getoptargv \
	common/misc/handle \
	common/misc/handletable \
	common/misc/handletablectx \
	common/misc/handletablesimple \
	common/misc/lockvalidator \
	common/misc/message \
	common/misc/once \
	common/misc/req \
	common/misc/reqpool \
	common/misc/reqqueue \
	common/misc/sanity-c \
	common/misc/sanity-cpp \
	common/misc/semspingpong \
	common/misc/sg \
	common/misc/circbuf \
	common/misc/thread \
	common/misc/term \
	common/misc/uri \
	common/net/netaddrstr2 \
	common/net/macstr \
	common/path/rtPathRootSpecLen \
	common/path/rtPathVolumeSpecLen \
	common/path/RTPathAbsDup \
	common/path/RTPathAbsEx \
	common/path/RTPathAbsExDup \
	common/path/RTPathAppend \
	common/path/RTPathAppendEx \
	common/path/RTPathCalcRelative \
	common/path/RTPathChangeToDosSlashes \
	common/path/RTPathChangeToUnixSlashes \
	common/path/RTPathCopyComponents \
	common/path/RTPathCountComponents \
	common/path/RTPathExt \
	common/path/RTPathFilename \
	common/path/RTPathHasExt \
	common/path/RTPathHasPath \
	common/path/RTPathJoin \
	common/path/RTPathJoinA \
	common/path/RTPathJoinEx \
	common/path/RTPathParse \
	common/path/RTPathParsedReassemble \
	common/path/RTPathParseSimple \
	common/path/RTPathRealDup \
	common/path/RTPathRmCmd \
	common/path/RTPathSplit \
	common/path/RTPathSplitA \
	common/path/RTPathSplitReassemble \
	common/path/RTPathStartsWithRoot \
	common/path/RTPathStripExt \
	common/path/RTPathStripFilename \
	common/path/RTPathStripTrailingSlash \
	common/path/RTPathTraverseList \
	common/path/comparepaths \
	common/rand/rand \
	common/rand/randadv \
	common/rand/randparkmiller \
	common/sort/RTSortIsSorted \
	common/sort/RTSortApvIsSorted \
	common/sort/shellsort \
	common/string/RTStrCat \
	common/string/RTStrCatEx \
	common/string/RTStrCatP \
	common/string/RTStrCatPEx \
	common/string/RTStrCmp \
	common/string/RTStrCopy \
	common/string/RTStrCopyEx \
	common/string/RTStrCopyP \
	common/string/RTStrCopyPEx \
	common/string/RTStrNCmp \
	common/string/RTStrNLen \
	common/string/RTStrNLenEx \
	common/string/RTStrPrintHexBytes \
	common/string/RTStrStr \
	common/string/RTUtf16Copy \
	common/string/RTUtf16CopyAscii \
	common/string/RTUtf16Cat \
	common/string/RTUtf16CatAscii \
	common/string/RTUtf16CmpAscii \
	common/string/RTUtf16ICmpAscii \
	common/string/RTUtf16End \
	common/string/RTUtf16NLen \
	common/string/RTUtf16NLenEx \
	common/string/RTUtf16PrintHexBytes \
	common/string/base64 \
	common/string/simplepattern \
	common/string/straprintf \
	common/string/strformat \
	common/string/strformatnum \
	common/string/strformatrt \
	common/string/strformattype \
	common/string/strhash1 \
	common/string/stringalloc \
	common/string/strprintf \
	common/string/strcache \
	common/string/strspace \
	common/string/strstrip \
	common/string/strtonum \
	common/string/strversion \
	common/string/uni \
	common/string/unidata-flags \
	common/string/unidata-lower \
	common/string/unidata-upper \
	common/string/utf-16 \
	common/string/utf-16-case \
	common/string/utf-16-latin-1 \
	common/string/utf-8 \
	common/string/utf-8-case \
	common/string/utf-8-case2 \
	common/string/ministring \
	common/table/avlgcptr \
	common/table/avlhcphys \
	common/table/avlgcphys \
	common/table/avllu32 \
	common/table/avlou32 \
	common/table/avlogcphys \
	common/table/avlogcptr \
	common/table/avlohcphys \
	common/table/avloioport \
	common/table/avlpv \
	common/table/avlrgcptr \
	common/table/avlrogcphys \
	common/table/avlrogcptr \
	common/table/avlroioport \
	common/table/avlroogcptr \
	common/table/avlrpv \
	common/table/avlruintptr \
	common/table/avlrfoff \
	common/table/avlru64 \
	common/table/avlu32 \
	common/table/avluintptr \
	common/table/avlul \
	common/table/table \
	common/time/time \
	common/time/timeprog \
	common/time/timesup \
	common/vfs/vfsbase \
	common/vfs/vfschain \
	common/vfs/vfsiosmisc \
	common/vfs/vfsmemory \
	common/vfs/vfsmisc \
	common/vfs/vfsstdfile \
	common/zip/tar \
	common/zip/tarcmd \
	common/zip/unzipcmd \
	common/zip/tarvfs \
	common/zip/gzipvfs \
	common/zip/pkzip \
	common/zip/pkzipvfs \
	common/zip/zip \
	generic/createtemp-generic \
	generic/critsect-generic \
	generic/critsectrw-generic \
	generic/env-generic \
	generic/RTDirCreateUniqueNumbered-generic \
	generic/RTEnvDupEx-generic \
	generic/RTFileCopy-generic \
	generic/RTFileQuerySize-generic \
	generic/RTFileReadAll-generic \
	generic/RTFileReadAllEx-generic \
	generic/RTFileReadAllByHandle-generic \
	generic/RTFileReadAllByHandleEx-generic \
	generic/RTFileReadAllFree-generic \
	generic/RTLogWriteStdErr-generic \
	generic/RTLogWriteStdOut-generic \
	generic/RTLogWriteUser-generic \
	generic/RTPathGetCurrentDrive-generic \
	generic/RTPathIsSame-generic \
	generic/RTProcessQueryUsernameA-generic \
	generic/RTTimerLRCreate-generic \
	generic/mempool-generic \
	generic/semfastmutex-generic \
	generic/semxroads-generic \
	generic/spinlock-generic \
	generic/timerlr-generic \
	r3/alloc-ef \
	r3/alloc \
	r3/allocex \
	r3/dir \
	r3/dir2 \
	r3/fileio \
	r3/fs \
	r3/init \
	r3/isofs \
	r3/memsafer-r3 \
	r3/path \
	r3/poll \
	r3/process \
	r3/socket \
	r3/stream \
	r3/test \
	r3/testi \
	r3/tcp \
	r3/udp \
	r3/generic/semspinmutex-r3-generic \
	r3/xml \
	common/zip/xarvfs 
    
FILES += \
    generic/cdrom-generic \
	generic/RTDirQueryInfo-generic \
	generic/RTDirSetTimes-generic \
	generic/RTFileMove-generic \
	generic/RTLogWriteDebugger-generic \
	generic/RTPathAbs-generic \
	generic/RTPathGetCurrentOnDrive-generic \
	generic/RTProcDaemonize-generic \
 	generic/RTSemEventMultiWait-2-ex-generic \
 	generic/RTSemEventMultiWaitNoResume-2-ex-generic \
	generic/RTTimeLocalNow-generic \
	generic/RTTimerCreate-generic \
	generic/RTThreadSetAffinityToCpu-generic \
	generic/RTUuidCreate-generic \
	generic/mppresent-generic \
	generic/utf16locale-generic \
	generic/uuid-generic \
	r3/posix/allocex-r3-posix \
	r3/linux/RTThreadGetNativeState-linux \
	r3/linux/mp-linux \
	r3/linux/rtProcInitExePath-linux \
	r3/linux/sched-linux \
	r3/linux/sysfs \
	r3/linux/time-linux \
	r3/linux/thread-affinity-linux \
	r3/linux/RTProcIsRunningByName-linux \
	r3/linux/RTSystemQueryDmiString-linux \
	r3/linux/RTSystemShutdown-linux \
	r3/posix/RTFileQueryFsSizes-posix \
	r3/posix/RTHandleGetStandard-posix \
	r3/posix/RTMemProtect-posix \
	r3/posix/RTPathUserHome-posix \
	r3/posix/RTSystemQueryOSInfo-posix \
	r3/linux/systemmem-linux \
	r3/posix/RTTimeNow-posix \
	r3/posix/RTTimeSet-posix \
	r3/posix/rtmempage-exec-mmap-heap-posix \
	r3/posix/dir-posix \
	r3/posix/env-posix \
	r3/posix/errvars-posix \
	r3/posix/fileio-posix \
	r3/posix/fileio2-posix \
	r3/posix/filelock-posix \
	r3/posix/fs-posix \
	r3/posix/fs2-posix \
	r3/posix/fs3-posix \
	r3/posix/ldrNative-posix \
	r3/posix/path-posix \
	r3/posix/path2-posix \
	r3/posix/pathhost-posix \
	r3/posix/RTPathUserDocuments-posix \
	r3/posix/pipe-posix \
	r3/posix/process-posix \
	r3/posix/process-creation-posix \
	r3/posix/rand-posix \
	r3/posix/semrw-posix \
	r3/posix/symlink-posix \
	r3/posix/thread-posix \
	r3/posix/thread2-posix \
	r3/posix/timelocal-posix \
	r3/posix/timer-posix \
	r3/posix/tls-posix \
	r3/posix/utf8-posix \
 	r3/posix/semevent-posix \
 	r3/posix/semeventmulti-posix \
 	r3/posix/semmutex-posix
    
#LIB_DEFS = iprt.def

FLAGS = -Iinclude -DRT_OS_LINUX -DRT_NO_GIP -DIPRT_BLDCFG_SCM_REV -DIPRT_BLDCFG_VERSION_STRING 

CXXFLAGS += $(FLAGS)
CFLAGS += $(FLAGS)
ASFLAGS += $(FLAGS) -I$(TOP)/include/ -f elf32 -DASM_FORMAT_ELF -D__YASM__ -Worphan-labels -DRT_ARCH_X86 

ifeq ($(ARCH), WIN_NT)
LDFLAGS += user32.lib ws2_32.lib
else
ifeq ($(ARCH),FreeBSD)
LDFLAGS += -lpthread
else
ifeq ($(ARCH), OSF1)
LDFLAGS += -lpthread
else
ifndef IRIX_64BIT
LDFLAGS += -ldl -lpthread
else
LDFLAGS += -lpthread
endif
endif
endif
endif

include ${TOP}/cr.mk
